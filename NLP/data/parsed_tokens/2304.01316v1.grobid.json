{
  "title": [
    {
      "sentence": "Matched Machine Learning: A Generalized Framework for Treatment Effect Inference With Learned Metrics",
      "tokens": [
        "Matched",
        "Machine",
        "Learning",
        ":",
        "A",
        "Generalized",
        "Framework",
        "for",
        "Treatment",
        "Effect",
        "Inference",
        "With",
        "Learned",
        "Metrics"
      ]
    }
  ],
  "abstract": [
    {
      "sentence": "We introduce Matched Machine Learning, a framework that combines the flexibility of machine learning black boxes with the interpretability of matching, a longstanding tool in observational causal inference.",
      "tokens": [
        "We",
        "introduce",
        "Matched",
        "Machine",
        "Learning",
        ",",
        "a",
        "framework",
        "that",
        "combines",
        "the",
        "flexibility",
        "of",
        "machine",
        "learning",
        "black",
        "boxes",
        "with",
        "the",
        "interpretability",
        "of",
        "matching",
        ",",
        "a",
        "longstanding",
        "tool",
        "in",
        "observational",
        "causal",
        "inference",
        "."
      ]
    },
    {
      "sentence": "Interpretability is paramount in many highstakes application of causal inference.",
      "tokens": [
        "Interpretability",
        "is",
        "paramount",
        "in",
        "many",
        "highstakes",
        "application",
        "of",
        "causal",
        "inference",
        "."
      ]
    },
    {
      "sentence": "Current tools for nonparametric estimation of both average and individualized treatment effects are black-boxes that do not allow for human auditing of estimates.",
      "tokens": [
        "Current",
        "tools",
        "for",
        "nonparametric",
        "estimation",
        "of",
        "both",
        "average",
        "and",
        "individualized",
        "treatment",
        "effects",
        "are",
        "black-boxes",
        "that",
        "do",
        "not",
        "allow",
        "for",
        "human",
        "auditing",
        "of",
        "estimates",
        "."
      ]
    },
    {
      "sentence": "Our framework uses machine learning to learn an optimal metric for matching units and estimating outcomes, thus achieving the performance of machine learning black-boxes, while being interpretable.",
      "tokens": [
        "Our",
        "framework",
        "uses",
        "machine",
        "learning",
        "to",
        "learn",
        "an",
        "optimal",
        "metric",
        "for",
        "matching",
        "units",
        "and",
        "estimating",
        "outcomes",
        ",",
        "thus",
        "achieving",
        "the",
        "performance",
        "of",
        "machine",
        "learning",
        "black-boxes",
        ",",
        "while",
        "being",
        "interpretable",
        "."
      ]
    },
    {
      "sentence": "Our general framework encompasses several published works as special cases.",
      "tokens": [
        "Our",
        "general",
        "framework",
        "encompasses",
        "several",
        "published",
        "works",
        "as",
        "special",
        "cases",
        "."
      ]
    },
    {
      "sentence": "We provide asymptotic inference theory for our proposed framework, enabling users to construct approximate confidence intervals around estimates of both individualized and average treatment effects.",
      "tokens": [
        "We",
        "provide",
        "asymptotic",
        "inference",
        "theory",
        "for",
        "our",
        "proposed",
        "framework",
        ",",
        "enabling",
        "users",
        "to",
        "construct",
        "approximate",
        "confidence",
        "intervals",
        "around",
        "estimates",
        "of",
        "both",
        "individualized",
        "and",
        "average",
        "treatment",
        "effects",
        "."
      ]
    },
    {
      "sentence": "We show empirically that instances of Matched Machine Learning perform on par with black-box machine learning methods and better than existing matching methods for similar problems.",
      "tokens": [
        "We",
        "show",
        "empirically",
        "that",
        "instances",
        "of",
        "Matched",
        "Machine",
        "Learning",
        "perform",
        "on",
        "par",
        "with",
        "black-box",
        "machine",
        "learning",
        "methods",
        "and",
        "better",
        "than",
        "existing",
        "matching",
        "methods",
        "for",
        "similar",
        "problems",
        "."
      ]
    },
    {
      "sentence": "Finally, in our application we show how Matched Machine Learning can be used to perform causal inference even when covariate data are highly complex: we study an image dataset, and produce high quality matches and estimates of treatment effects.",
      "tokens": [
        "Finally",
        ",",
        "in",
        "our",
        "application",
        "we",
        "show",
        "how",
        "Matched",
        "Machine",
        "Learning",
        "can",
        "be",
        "used",
        "to",
        "perform",
        "causal",
        "inference",
        "even",
        "when",
        "covariate",
        "data",
        "are",
        "highly",
        "complex",
        ":",
        "we",
        "study",
        "an",
        "image",
        "dataset",
        ",",
        "and",
        "produce",
        "high",
        "quality",
        "matches",
        "and",
        "estimates",
        "of",
        "treatment",
        "effects",
        "."
      ]
    }
  ],
  "introduction": [
    {
      "sentence": "Introduction Matching methods have a long history in observational causal inference.",
      "tokens": [
        "Introduction",
        "Matching",
        "methods",
        "have",
        "a",
        "long",
        "history",
        "in",
        "observational",
        "causal",
        "inference",
        "."
      ]
    },
    {
      "sentence": "Their simplicity makes them interpretable even by non-technical audiences, as well as guarantees fast execution of causal analyses with known statistical properties, all while requiring no parametric assumptions on either outcome or treatment distributions (Rosenbaum and Rubin, 1983) .",
      "tokens": [
        "Their",
        "simplicity",
        "makes",
        "them",
        "interpretable",
        "even",
        "by",
        "non-technical",
        "audiences",
        ",",
        "as",
        "well",
        "as",
        "guarantees",
        "fast",
        "execution",
        "of",
        "causal",
        "analyses",
        "with",
        "known",
        "statistical",
        "properties",
        ",",
        "all",
        "while",
        "requiring",
        "no",
        "parametric",
        "assumptions",
        "on",
        "either",
        "outcome",
        "or",
        "treatment",
        "distributions",
        "(",
        "Rosenbaum",
        "and",
        "Rubin",
        ",",
        "1983",
        ")",
        "."
      ]
    },
    {
      "sentence": "Recently, black-box machine learning (ML) tools for nonparametric estimation have come to supplant matching as the default for treatment effect estimation with contextual covariates (e.g., Hill, 2011; Wager and Athey, 2018; Chernozhukov et al., 2018; Hahn et al., 2020) .",
      "tokens": [
        "Recently",
        ",",
        "black-box",
        "machine",
        "learning",
        "(",
        "ML",
        ")",
        "tools",
        "for",
        "nonparametric",
        "estimation",
        "have",
        "come",
        "to",
        "supplant",
        "matching",
        "as",
        "the",
        "default",
        "for",
        "treatment",
        "effect",
        "estimation",
        "with",
        "contextual",
        "covariates",
        "(",
        "e.g.",
        ",",
        "Hill",
        ",",
        "2011",
        ";",
        "Wager",
        "and",
        "Athey",
        ",",
        "2018",
        ";",
        "Chernozhukov",
        "et",
        "al.",
        ",",
        "2018",
        ";",
        "Hahn",
        "et",
        "al.",
        ",",
        "2020",
        ")",
        "."
      ]
    },
    {
      "sentence": "There are good reasons for this: the complexity of ML black boxes allows them to predict treatment effects with an unprecedented degree of accuracy, which is sometimes not achieved by matching methods.",
      "tokens": [
        "There",
        "are",
        "good",
        "reasons",
        "for",
        "this",
        ":",
        "the",
        "complexity",
        "of",
        "ML",
        "black",
        "boxes",
        "allows",
        "them",
        "to",
        "predict",
        "treatment",
        "effects",
        "with",
        "an",
        "unprecedented",
        "degree",
        "of",
        "accuracy",
        ",",
        "which",
        "is",
        "sometimes",
        "not",
        "achieved",
        "by",
        "matching",
        "methods",
        "."
      ]
    },
    {
      "sentence": "However, the use of black box ML comes at a cost of interpretability in the results.",
      "tokens": [
        "However",
        ",",
        "the",
        "use",
        "of",
        "black",
        "box",
        "ML",
        "comes",
        "at",
        "a",
        "cost",
        "of",
        "interpretability",
        "in",
        "the",
        "results",
        "."
      ]
    },
    {
      "sentence": "Our main concern is that models that are not interpretable are difficult to audit, i.e., it is difficult to assess the robustness and credibility of results from an uninterpretable model using contextual information about the data, problem, or population under study.",
      "tokens": [
        "Our",
        "main",
        "concern",
        "is",
        "that",
        "models",
        "that",
        "are",
        "not",
        "interpretable",
        "are",
        "difficult",
        "to",
        "audit",
        ",",
        "i.e.",
        ",",
        "it",
        "is",
        "difficult",
        "to",
        "assess",
        "the",
        "robustness",
        "and",
        "credibility",
        "of",
        "results",
        "from",
        "an",
        "uninterpretable",
        "model",
        "using",
        "contextual",
        "information",
        "about",
        "the",
        "data",
        ",",
        "problem",
        ",",
        "or",
        "population",
        "under",
        "study",
        "."
      ]
    },
    {
      "sentence": "This in turn is problematic since most causal inference datasets can have myriad forms of hidden noise, as well as unmeasured confounding.",
      "tokens": [
        "This",
        "in",
        "turn",
        "is",
        "problematic",
        "since",
        "most",
        "causal",
        "inference",
        "datasets",
        "can",
        "have",
        "myriad",
        "forms",
        "of",
        "hidden",
        "noise",
        ",",
        "as",
        "well",
        "as",
        "unmeasured",
        "confounding",
        "."
      ]
    },
    {
      "sentence": "In this paper, we propose to bridge the gap between the accuracy of ML and the auditability of matching by using the first to inform the second.",
      "tokens": [
        "In",
        "this",
        "paper",
        ",",
        "we",
        "propose",
        "to",
        "bridge",
        "the",
        "gap",
        "between",
        "the",
        "accuracy",
        "of",
        "ML",
        "and",
        "the",
        "auditability",
        "of",
        "matching",
        "by",
        "using",
        "the",
        "first",
        "to",
        "inform",
        "the",
        "second",
        "."
      ]
    },
    {
      "sentence": "We propose a general framework that first uses flexible ML to learn a distance metric for matching units, and then employs a matching algorithm that uses the learned metric to construct high-quality matches.",
      "tokens": [
        "We",
        "propose",
        "a",
        "general",
        "framework",
        "that",
        "first",
        "uses",
        "flexible",
        "ML",
        "to",
        "learn",
        "a",
        "distance",
        "metric",
        "for",
        "matching",
        "units",
        ",",
        "and",
        "then",
        "employs",
        "a",
        "matching",
        "algorithm",
        "that",
        "uses",
        "the",
        "learned",
        "metric",
        "to",
        "construct",
        "high-quality",
        "matches",
        "."
      ]
    },
    {
      "sentence": "These matches are designed to approximate the predictions of the black-box ML while still being auditable; after the matches are made, the black box is thrown out and the analysis proceeds with the matches only.",
      "tokens": [
        "These",
        "matches",
        "are",
        "designed",
        "to",
        "approximate",
        "the",
        "predictions",
        "of",
        "the",
        "black-box",
        "ML",
        "while",
        "still",
        "being",
        "auditable",
        ";",
        "after",
        "the",
        "matches",
        "are",
        "made",
        ",",
        "the",
        "black",
        "box",
        "is",
        "thrown",
        "out",
        "and",
        "the",
        "analysis",
        "proceeds",
        "with",
        "the",
        "matches",
        "only",
        "."
      ]
    },
    {
      "sentence": "Analysts can then audit quality of the matched estimate by simply examining the matches themselves.",
      "tokens": [
        "Analysts",
        "can",
        "then",
        "audit",
        "quality",
        "of",
        "the",
        "matched",
        "estimate",
        "by",
        "simply",
        "examining",
        "the",
        "matches",
        "themselves",
        "."
      ]
    },
    {
      "sentence": "Methods from our framework output estimates for the Conditional Average Treatment Effect (CATE), i.e., the expected effect on any individual unit (also known as individualized treatment effect), the Average Treatment Effect (ATE), and Average Treatment Effect on the Treated (ATT), which are average treatment effects on respectively all or only the treated units.",
      "tokens": [
        "Methods",
        "from",
        "our",
        "framework",
        "output",
        "estimates",
        "for",
        "the",
        "Conditional",
        "Average",
        "Treatment",
        "Effect",
        "(",
        "CATE",
        ")",
        ",",
        "i.e.",
        ",",
        "the",
        "expected",
        "effect",
        "on",
        "any",
        "individual",
        "unit",
        "(",
        "also",
        "known",
        "as",
        "individualized",
        "treatment",
        "effect",
        ")",
        ",",
        "the",
        "Average",
        "Treatment",
        "Effect",
        "(",
        "ATE",
        ")",
        ",",
        "and",
        "Average",
        "Treatment",
        "Effect",
        "on",
        "the",
        "Treated",
        "(",
        "ATT",
        ")",
        ",",
        "which",
        "are",
        "average",
        "treatment",
        "effects",
        "on",
        "respectively",
        "all",
        "or",
        "only",
        "the",
        "treated",
        "units",
        "."
      ]
    },
    {
      "sentence": "Our paper makes several key contributions to the literature on matching and treatment effect estimation in general: (i) We introduce a framework for the production of interpretable treatment effect estimates that are still black-box accurate for the CATE.",
      "tokens": [
        "Our",
        "paper",
        "makes",
        "several",
        "key",
        "contributions",
        "to",
        "the",
        "literature",
        "on",
        "matching",
        "and",
        "treatment",
        "effect",
        "estimation",
        "in",
        "general",
        ":",
        "(",
        "i",
        ")",
        "We",
        "introduce",
        "a",
        "framework",
        "for",
        "the",
        "production",
        "of",
        "interpretable",
        "treatment",
        "effect",
        "estimates",
        "that",
        "are",
        "still",
        "black-box",
        "accurate",
        "for",
        "the",
        "CATE",
        "."
      ]
    },
    {
      "sentence": "(ii) We derive the asymptotic distributions and error bounds for CATE estimates made with any matching method falling under our framework.",
      "tokens": [
        "(",
        "ii",
        ")",
        "We",
        "derive",
        "the",
        "asymptotic",
        "distributions",
        "and",
        "error",
        "bounds",
        "for",
        "CATE",
        "estimates",
        "made",
        "with",
        "any",
        "matching",
        "method",
        "falling",
        "under",
        "our",
        "framework",
        "."
      ]
    },
    {
      "sentence": "(iii) We expand our framework into a general, doubly-robust matching framework for valid √ n-asymptotic inference for the ATE/ATT.",
      "tokens": [
        "(",
        "iii",
        ")",
        "We",
        "expand",
        "our",
        "framework",
        "into",
        "a",
        "general",
        ",",
        "doubly-robust",
        "matching",
        "framework",
        "for",
        "valid",
        "√",
        "n-asymptotic",
        "inference",
        "for",
        "the",
        "ATE/ATT",
        "."
      ]
    },
    {
      "sentence": "We also show empirically that the finite-sample performance of our tools does indeed match that of black box ML, and theoretically, that our matched estimates are asymptotically normal and with known and estimable variance for conditional treatment effects.",
      "tokens": [
        "We",
        "also",
        "show",
        "empirically",
        "that",
        "the",
        "finite-sample",
        "performance",
        "of",
        "our",
        "tools",
        "does",
        "indeed",
        "match",
        "that",
        "of",
        "black",
        "box",
        "ML",
        ",",
        "and",
        "theoretically",
        ",",
        "that",
        "our",
        "matched",
        "estimates",
        "are",
        "asymptotically",
        "normal",
        "and",
        "with",
        "known",
        "and",
        "estimable",
        "variance",
        "for",
        "conditional",
        "treatment",
        "effects",
        "."
      ]
    },
    {
      "sentence": "In addition, we leverage Double Machine Learning (DML) (Chernozhukov et al., 2018) methodologies to combine CATEs from matching into a doubly-robust estimator to obtain estimates for average treatment effects that are asymptotically normal at a rate of √ n. Importantly, this last method allows us to sidestep the issue of the slow-vanishing asymptotic bias of many common matching methods brought up by Abadie and Imbens (2006) .",
      "tokens": [
        "In",
        "addition",
        ",",
        "we",
        "leverage",
        "Double",
        "Machine",
        "Learning",
        "(",
        "DML",
        ")",
        "(",
        "Chernozhukov",
        "et",
        "al.",
        ",",
        "2018",
        ")",
        "methodologies",
        "to",
        "combine",
        "CATEs",
        "from",
        "matching",
        "into",
        "a",
        "doubly-robust",
        "estimator",
        "to",
        "obtain",
        "estimates",
        "for",
        "average",
        "treatment",
        "effects",
        "that",
        "are",
        "asymptotically",
        "normal",
        "at",
        "a",
        "rate",
        "of",
        "√",
        "n.",
        "Importantly",
        ",",
        "this",
        "last",
        "method",
        "allows",
        "us",
        "to",
        "sidestep",
        "the",
        "issue",
        "of",
        "the",
        "slow-vanishing",
        "asymptotic",
        "bias",
        "of",
        "many",
        "common",
        "matching",
        "methods",
        "brought",
        "up",
        "by",
        "Abadie",
        "and",
        "Imbens",
        "(",
        "2006",
        ")",
        "."
      ]
    },
    {
      "sentence": "Our framework generalizes many known and widely-employed matching methods, some of which are summarized in Table 1 .",
      "tokens": [
        "Our",
        "framework",
        "generalizes",
        "many",
        "known",
        "and",
        "widely-employed",
        "matching",
        "methods",
        ",",
        "some",
        "of",
        "which",
        "are",
        "summarized",
        "in",
        "Table",
        "1",
        "."
      ]
    },
    {
      "sentence": "Importantly, the theoretical guarantees that we establish for our framework can be applied to any of the matching methods it generalizes.",
      "tokens": [
        "Importantly",
        ",",
        "the",
        "theoretical",
        "guarantees",
        "that",
        "we",
        "establish",
        "for",
        "our",
        "framework",
        "can",
        "be",
        "applied",
        "to",
        "any",
        "of",
        "the",
        "matching",
        "methods",
        "it",
        "generalizes",
        "."
      ]
    },
    {
      "sentence": "We expand on how our framework generalizes the matching methods in Table 1 in Section 6.",
      "tokens": [
        "We",
        "expand",
        "on",
        "how",
        "our",
        "framework",
        "generalizes",
        "the",
        "matching",
        "methods",
        "in",
        "Table",
        "1",
        "in",
        "Section",
        "6",
        "."
      ]
    },
    {
      "sentence": "We will demonstrate the power and flexibility of our method by matching on images, where we learn a low-dimensional representation of image covariates with a convolutional neural network.",
      "tokens": [
        "We",
        "will",
        "demonstrate",
        "the",
        "power",
        "and",
        "flexibility",
        "of",
        "our",
        "method",
        "by",
        "matching",
        "on",
        "images",
        ",",
        "where",
        "we",
        "learn",
        "a",
        "low-dimensional",
        "representation",
        "of",
        "image",
        "covariates",
        "with",
        "a",
        "convolutional",
        "neural",
        "network",
        "."
      ]
    },
    {
      "sentence": "We will show that our method produces interpretable matched groups even when input covariates are complex and high-dimensional, like images.",
      "tokens": [
        "We",
        "will",
        "show",
        "that",
        "our",
        "method",
        "produces",
        "interpretable",
        "matched",
        "groups",
        "even",
        "when",
        "input",
        "covariates",
        "are",
        "complex",
        "and",
        "high-dimensional",
        ",",
        "like",
        "images",
        "."
      ]
    },
    {
      "sentence": "While the representation we match on is uninterpretable, the results are visually auditable: humans will be able to visually inspect the matched groups of images and easily assess their quality and trustworthiness.",
      "tokens": [
        "While",
        "the",
        "representation",
        "we",
        "match",
        "on",
        "is",
        "uninterpretable",
        ",",
        "the",
        "results",
        "are",
        "visually",
        "auditable",
        ":",
        "humans",
        "will",
        "be",
        "able",
        "to",
        "visually",
        "inspect",
        "the",
        "matched",
        "groups",
        "of",
        "images",
        "and",
        "easily",
        "assess",
        "their",
        "quality",
        "and",
        "trustworthiness",
        "."
      ]
    },
    {
      "sentence": "This will enable us to study whether brand responsiveness to consumers on social media is associated with an increase Table 1 : Some existing matching methods that are special cases of M-ML.",
      "tokens": [
        "This",
        "will",
        "enable",
        "us",
        "to",
        "study",
        "whether",
        "brand",
        "responsiveness",
        "to",
        "consumers",
        "on",
        "social",
        "media",
        "is",
        "associated",
        "with",
        "an",
        "increase",
        "Table",
        "1",
        ":",
        "Some",
        "existing",
        "matching",
        "methods",
        "that",
        "are",
        "special",
        "cases",
        "of",
        "M-ML",
        "."
      ]
    },
    {
      "sentence": "Method Choice of φ Choice of q Nearest Neighbor φ(x) = x, 2 Propensity Score Matching φ(x) = h(x), h ∈ arg min h∈H E X [(h(X) -Pr(T i = t|X)) 2 ] 1 (Rosenbaum and Rubin, 1983) Prognostic Score Matching φ(x) = h(x), h ∈ arg min h∈H E X,Y i (t) [(h(X) -Y i (t)) 2 ] 1 (Hansen, 2008) Adaptive Hyper-Boxes * φ(x) = [h t (x), h t (x)] ( Morucci et al., 2020) h t ∈ arg min h∈H E X,Y i (t) [(h(X) et al., 2012) Γ ∈ R p×p diag is a matrix of dimension-wise calipers Genetic φ(x) = Mx 2 (Diamond and Sekhon, 2013) M ∈ arg min M∈R p×p diag i,j∈Tr Maha(x i , x j , M) MALTS φ(x) = Mx, 2 (Parikh et al., 2022) M ∈ arg min M∈R p×p diag i,j∈Tr (y i -y j ) exp(-Maha(x i ,x j ,M)I(T i =T j )) -Y i (t)) 2 ] 1 h t ∈ arg min h∈H E X,Y i (t ) [(h(X) -Y i (t )) 2 ] Coarsened Exact Matching φ(x) = Γx ∞ (Iacus k∈T r exp(-Maha(x i ,x k ,M)I(t i =t k )) Fine Balance * φ(x) = h(x), h ∈ arg min h∈H E X [(h(X) -Pr(T i = t|X)) 2 ] 1 (Rosenbaum et al., 2007) Note: * Requires additional constraints on the matching problem.",
      "tokens": [
        "Method",
        "Choice",
        "of",
        "φ",
        "Choice",
        "of",
        "q",
        "Nearest",
        "Neighbor",
        "φ",
        "(",
        "x",
        ")",
        "=",
        "x",
        ",",
        "2",
        "Propensity",
        "Score",
        "Matching",
        "φ",
        "(",
        "x",
        ")",
        "=",
        "h",
        "(",
        "x",
        ")",
        ",",
        "h",
        "∈",
        "arg",
        "min",
        "h∈H",
        "E",
        "X",
        "[",
        "(",
        "h",
        "(",
        "X",
        ")",
        "-Pr",
        "(",
        "T",
        "i",
        "=",
        "t|X",
        ")",
        ")",
        "2",
        "]",
        "1",
        "(",
        "Rosenbaum",
        "and",
        "Rubin",
        ",",
        "1983",
        ")",
        "Prognostic",
        "Score",
        "Matching",
        "φ",
        "(",
        "x",
        ")",
        "=",
        "h",
        "(",
        "x",
        ")",
        ",",
        "h",
        "∈",
        "arg",
        "min",
        "h∈H",
        "E",
        "X",
        ",",
        "Y",
        "i",
        "(",
        "t",
        ")",
        "[",
        "(",
        "h",
        "(",
        "X",
        ")",
        "-Y",
        "i",
        "(",
        "t",
        ")",
        ")",
        "2",
        "]",
        "1",
        "(",
        "Hansen",
        ",",
        "2008",
        ")",
        "Adaptive",
        "Hyper-Boxes",
        "*",
        "φ",
        "(",
        "x",
        ")",
        "=",
        "[",
        "h",
        "t",
        "(",
        "x",
        ")",
        ",",
        "h",
        "t",
        "(",
        "x",
        ")",
        "]",
        "(",
        "Morucci",
        "et",
        "al.",
        ",",
        "2020",
        ")",
        "h",
        "t",
        "∈",
        "arg",
        "min",
        "h∈H",
        "E",
        "X",
        ",",
        "Y",
        "i",
        "(",
        "t",
        ")",
        "[",
        "(",
        "h",
        "(",
        "X",
        ")",
        "et",
        "al.",
        ",",
        "2012",
        ")",
        "Γ",
        "∈",
        "R",
        "p×p",
        "diag",
        "is",
        "a",
        "matrix",
        "of",
        "dimension-wise",
        "calipers",
        "Genetic",
        "φ",
        "(",
        "x",
        ")",
        "=",
        "Mx",
        "2",
        "(",
        "Diamond",
        "and",
        "Sekhon",
        ",",
        "2013",
        ")",
        "M",
        "∈",
        "arg",
        "min",
        "M∈R",
        "p×p",
        "diag",
        "i",
        ",",
        "j∈Tr",
        "Maha",
        "(",
        "x",
        "i",
        ",",
        "x",
        "j",
        ",",
        "M",
        ")",
        "MALTS",
        "φ",
        "(",
        "x",
        ")",
        "=",
        "Mx",
        ",",
        "2",
        "(",
        "Parikh",
        "et",
        "al.",
        ",",
        "2022",
        ")",
        "M",
        "∈",
        "arg",
        "min",
        "M∈R",
        "p×p",
        "diag",
        "i",
        ",",
        "j∈Tr",
        "(",
        "y",
        "i",
        "-y",
        "j",
        ")",
        "exp",
        "(",
        "-Maha",
        "(",
        "x",
        "i",
        ",",
        "x",
        "j",
        ",",
        "M",
        ")",
        "I",
        "(",
        "T",
        "i",
        "=T",
        "j",
        ")",
        ")",
        "-Y",
        "i",
        "(",
        "t",
        ")",
        ")",
        "2",
        "]",
        "1",
        "h",
        "t",
        "∈",
        "arg",
        "min",
        "h∈H",
        "E",
        "X",
        ",",
        "Y",
        "i",
        "(",
        "t",
        ")",
        "[",
        "(",
        "h",
        "(",
        "X",
        ")",
        "-Y",
        "i",
        "(",
        "t",
        ")",
        ")",
        "2",
        "]",
        "Coarsened",
        "Exact",
        "Matching",
        "φ",
        "(",
        "x",
        ")",
        "=",
        "Γx",
        "∞",
        "(",
        "Iacus",
        "k∈T",
        "r",
        "exp",
        "(",
        "-Maha",
        "(",
        "x",
        "i",
        ",",
        "x",
        "k",
        ",",
        "M",
        ")",
        "I",
        "(",
        "t",
        "i",
        "=t",
        "k",
        ")",
        ")",
        "Fine",
        "Balance",
        "*",
        "φ",
        "(",
        "x",
        ")",
        "=",
        "h",
        "(",
        "x",
        ")",
        ",",
        "h",
        "∈",
        "arg",
        "min",
        "h∈H",
        "E",
        "X",
        "[",
        "(",
        "h",
        "(",
        "X",
        ")",
        "-Pr",
        "(",
        "T",
        "i",
        "=",
        "t|X",
        ")",
        ")",
        "2",
        "]",
        "1",
        "(",
        "Rosenbaum",
        "et",
        "al.",
        ",",
        "2007",
        ")",
        "Note",
        ":",
        "*",
        "Requires",
        "additional",
        "constraints",
        "on",
        "the",
        "matching",
        "problem",
        "."
      ]
    },
    {
      "sentence": "The parameters φ and q are M-ML hyperparameters that will be defined later; setting them to the values in the table give us the methods in the left column.",
      "tokens": [
        "The",
        "parameters",
        "φ",
        "and",
        "q",
        "are",
        "M-ML",
        "hyperparameters",
        "that",
        "will",
        "be",
        "defined",
        "later",
        ";",
        "setting",
        "them",
        "to",
        "the",
        "values",
        "in",
        "the",
        "table",
        "give",
        "us",
        "the",
        "methods",
        "in",
        "the",
        "left",
        "column",
        "."
      ]
    },
    {
      "sentence": "φ is a mapping from the original space to a useful feature space.",
      "tokens": [
        "φ",
        "is",
        "a",
        "mapping",
        "from",
        "the",
        "original",
        "space",
        "to",
        "a",
        "useful",
        "feature",
        "space",
        "."
      ]
    },
    {
      "sentence": "It is estimated using a machine learning model.",
      "tokens": [
        "It",
        "is",
        "estimated",
        "using",
        "a",
        "machine",
        "learning",
        "model",
        "."
      ]
    },
    {
      "sentence": "That machine learning model minimizes the loss function shown in the table.",
      "tokens": [
        "That",
        "machine",
        "learning",
        "model",
        "minimizes",
        "the",
        "loss",
        "function",
        "shown",
        "in",
        "the",
        "table",
        "."
      ]
    },
    {
      "sentence": "q defines a distance metric in the learned feature space.",
      "tokens": [
        "q",
        "defines",
        "a",
        "distance",
        "metric",
        "in",
        "the",
        "learned",
        "feature",
        "space",
        "."
      ]
    },
    {
      "sentence": "See Section 6 for an in-depth explanation of this table.",
      "tokens": [
        "See",
        "Section",
        "6",
        "for",
        "an",
        "in-depth",
        "explanation",
        "of",
        "this",
        "table",
        "."
      ]
    },
    {
      "sentence": "Treatment represented by the random variable T , a specific treatment level is t, covariates are X (or x if not random), potential outcomes are Y (t), Tr is a training set, Maha(x i , x j , M) is the Mahalanobis distance of the covariate vectors of units i and j weighted by the positive, real-valued diagonal matrix M. in consumer interaction with the brand.",
      "tokens": [
        "Treatment",
        "represented",
        "by",
        "the",
        "random",
        "variable",
        "T",
        ",",
        "a",
        "specific",
        "treatment",
        "level",
        "is",
        "t",
        ",",
        "covariates",
        "are",
        "X",
        "(",
        "or",
        "x",
        "if",
        "not",
        "random",
        ")",
        ",",
        "potential",
        "outcomes",
        "are",
        "Y",
        "(",
        "t",
        ")",
        ",",
        "Tr",
        "is",
        "a",
        "training",
        "set",
        ",",
        "Maha",
        "(",
        "x",
        "i",
        ",",
        "x",
        "j",
        ",",
        "M",
        ")",
        "is",
        "the",
        "Mahalanobis",
        "distance",
        "of",
        "the",
        "covariate",
        "vectors",
        "of",
        "units",
        "i",
        "and",
        "j",
        "weighted",
        "by",
        "the",
        "positive",
        ",",
        "real-valued",
        "diagonal",
        "matrix",
        "M.",
        "in",
        "consumer",
        "interaction",
        "with",
        "the",
        "brand",
        "."
      ]
    },
    {
      "sentence": "This is an important problem in marketing and consumer behavior (e.g., Laroche et al., 2013) , but so far it has not been studied at the level of granularity that our method enables.",
      "tokens": [
        "This",
        "is",
        "an",
        "important",
        "problem",
        "in",
        "marketing",
        "and",
        "consumer",
        "behavior",
        "(",
        "e.g.",
        ",",
        "Laroche",
        "et",
        "al.",
        ",",
        "2013",
        ")",
        ",",
        "but",
        "so",
        "far",
        "it",
        "has",
        "not",
        "been",
        "studied",
        "at",
        "the",
        "level",
        "of",
        "granularity",
        "that",
        "our",
        "method",
        "enables",
        "."
      ]
    },
    {
      "sentence": "Our paper will proceed as follows: In Section 2, we introduce matching methods in general.",
      "tokens": [
        "Our",
        "paper",
        "will",
        "proceed",
        "as",
        "follows",
        ":",
        "In",
        "Section",
        "2",
        ",",
        "we",
        "introduce",
        "matching",
        "methods",
        "in",
        "general",
        "."
      ]
    },
    {
      "sentence": "In Section 3, we outline the Matched Machine Learning framework for estimation of Conditional Average Treatment Effects by matching units on learned distance metrics.",
      "tokens": [
        "In",
        "Section",
        "3",
        ",",
        "we",
        "outline",
        "the",
        "Matched",
        "Machine",
        "Learning",
        "framework",
        "for",
        "estimation",
        "of",
        "Conditional",
        "Average",
        "Treatment",
        "Effects",
        "by",
        "matching",
        "units",
        "on",
        "learned",
        "distance",
        "metrics",
        "."
      ]
    },
    {
      "sentence": "In Section 4, we present large-sample theoretical properties of our methodology.",
      "tokens": [
        "In",
        "Section",
        "4",
        ",",
        "we",
        "present",
        "large-sample",
        "theoretical",
        "properties",
        "of",
        "our",
        "methodology",
        "."
      ]
    },
    {
      "sentence": "In Section 5, we propose an algorithm for asymptotically efficient matched estimation of the Average Treatment Effect.",
      "tokens": [
        "In",
        "Section",
        "5",
        ",",
        "we",
        "propose",
        "an",
        "algorithm",
        "for",
        "asymptotically",
        "efficient",
        "matched",
        "estimation",
        "of",
        "the",
        "Average",
        "Treatment",
        "Effect",
        "."
      ]
    },
    {
      "sentence": "Section 7 presents empirical evidence of the performance of our methods on simulated datasets.",
      "tokens": [
        "Section",
        "7",
        "presents",
        "empirical",
        "evidence",
        "of",
        "the",
        "performance",
        "of",
        "our",
        "methods",
        "on",
        "simulated",
        "datasets",
        "."
      ]
    },
    {
      "sentence": "Finally, in Section 8, we apply our methods to the problem of studying the impact of brand responsiveness on social media on the amount of consumer interaction with the brand.",
      "tokens": [
        "Finally",
        ",",
        "in",
        "Section",
        "8",
        ",",
        "we",
        "apply",
        "our",
        "methods",
        "to",
        "the",
        "problem",
        "of",
        "studying",
        "the",
        "impact",
        "of",
        "brand",
        "responsiveness",
        "on",
        "social",
        "media",
        "on",
        "the",
        "amount",
        "of",
        "consumer",
        "interaction",
        "with",
        "the",
        "brand",
        "."
      ]
    }
  ]
}