{
  "title": [
    {
      "sentence": "pystacked: Stacking generalization and machine learning in Stata",
      "tokens": [
        "pystacked",
        ":",
        "Stacking",
        "generalization",
        "and",
        "machine",
        "learning",
        "in",
        "Stata"
      ]
    }
  ],
  "abstract": [
    {
      "sentence": "pystacked implements stacked generalization (Wolpert, 1992) for regression and binary classification via Python's scikit-learn.",
      "tokens": [
        "pystacked",
        "implements",
        "stacked",
        "generalization",
        "(",
        "Wolpert",
        ",",
        "1992",
        ")",
        "for",
        "regression",
        "and",
        "binary",
        "classification",
        "via",
        "Python",
        "'s",
        "scikit-learn",
        "."
      ]
    },
    {
      "sentence": "Stacking combines multiple supervised machine learners-the \"base\" or \"level-0\" learners-into a single learner.",
      "tokens": [
        "Stacking",
        "combines",
        "multiple",
        "supervised",
        "machine",
        "learners-the",
        "``",
        "base",
        "''",
        "or",
        "``",
        "level-0",
        "''",
        "learners-into",
        "a",
        "single",
        "learner",
        "."
      ]
    },
    {
      "sentence": "The currently supported base learners include regularized regression, random forest, gradient boosted trees, support vector machines, and feed-forward neural nets (multi-layer perceptron).",
      "tokens": [
        "The",
        "currently",
        "supported",
        "base",
        "learners",
        "include",
        "regularized",
        "regression",
        ",",
        "random",
        "forest",
        ",",
        "gradient",
        "boosted",
        "trees",
        ",",
        "support",
        "vector",
        "machines",
        ",",
        "and",
        "feed-forward",
        "neural",
        "nets",
        "(",
        "multi-layer",
        "perceptron",
        ")",
        "."
      ]
    },
    {
      "sentence": "pystacked can also be used as a 'regular' machine learning program to fit a single base learner and, thus, provides an easyto-use API for scikit-learn's machine learning algorithms.",
      "tokens": [
        "pystacked",
        "can",
        "also",
        "be",
        "used",
        "as",
        "a",
        "'regular",
        "'",
        "machine",
        "learning",
        "program",
        "to",
        "fit",
        "a",
        "single",
        "base",
        "learner",
        "and",
        ",",
        "thus",
        ",",
        "provides",
        "an",
        "easyto-use",
        "API",
        "for",
        "scikit-learn",
        "'s",
        "machine",
        "learning",
        "algorithms",
        "."
      ]
    }
  ],
  "introduction": [
    {
      "sentence": "Introduction When faced with a new prediction or classification task, it is a priori rarely obvious which machine learning algorithm is best suited.",
      "tokens": [
        "Introduction",
        "When",
        "faced",
        "with",
        "a",
        "new",
        "prediction",
        "or",
        "classification",
        "task",
        ",",
        "it",
        "is",
        "a",
        "priori",
        "rarely",
        "obvious",
        "which",
        "machine",
        "learning",
        "algorithm",
        "is",
        "best",
        "suited",
        "."
      ]
    },
    {
      "sentence": "A common approach is to evaluate the performance of a set of machine learners on a hold-out partition of the data or via cross-validation and then select the machine learner that minimizes a chosen loss metric.",
      "tokens": [
        "A",
        "common",
        "approach",
        "is",
        "to",
        "evaluate",
        "the",
        "performance",
        "of",
        "a",
        "set",
        "of",
        "machine",
        "learners",
        "on",
        "a",
        "hold-out",
        "partition",
        "of",
        "the",
        "data",
        "or",
        "via",
        "cross-validation",
        "and",
        "then",
        "select",
        "the",
        "machine",
        "learner",
        "that",
        "minimizes",
        "a",
        "chosen",
        "loss",
        "metric",
        "."
      ]
    },
    {
      "sentence": "However, this approach is incomplete as combining multiple learners into one final prediction might lead to superior performance compared to each individual learner.",
      "tokens": [
        "However",
        ",",
        "this",
        "approach",
        "is",
        "incomplete",
        "as",
        "combining",
        "multiple",
        "learners",
        "into",
        "one",
        "final",
        "prediction",
        "might",
        "lead",
        "to",
        "superior",
        "performance",
        "compared",
        "to",
        "each",
        "individual",
        "learner",
        "."
      ]
    },
    {
      "sentence": "This possibility motivates stacked generalization, or simply stacking, due to Wolpert (1992) and Breiman (1996) .",
      "tokens": [
        "This",
        "possibility",
        "motivates",
        "stacked",
        "generalization",
        ",",
        "or",
        "simply",
        "stacking",
        ",",
        "due",
        "to",
        "Wolpert",
        "(",
        "1992",
        ")",
        "and",
        "Breiman",
        "(",
        "1996",
        ")",
        "."
      ]
    },
    {
      "sentence": "Stacking is a form of model averaging.",
      "tokens": [
        "Stacking",
        "is",
        "a",
        "form",
        "of",
        "model",
        "averaging",
        "."
      ]
    },
    {
      "sentence": "Theoretical results in van der Laan et al.",
      "tokens": [
        "Theoretical",
        "results",
        "in",
        "van",
        "der",
        "Laan",
        "et",
        "al",
        "."
      ]
    },
    {
      "sentence": "(2007) support the use of stacking as it performs asymptotically at least as well as the best-performing individual learner as long as the number of base learners is not too large.",
      "tokens": [
        "(",
        "2007",
        ")",
        "support",
        "the",
        "use",
        "of",
        "stacking",
        "as",
        "it",
        "performs",
        "asymptotically",
        "at",
        "least",
        "as",
        "well",
        "as",
        "the",
        "best-performing",
        "individual",
        "learner",
        "as",
        "long",
        "as",
        "the",
        "number",
        "of",
        "base",
        "learners",
        "is",
        "not",
        "too",
        "large",
        "."
      ]
    },
    {
      "sentence": "In this article, we introduce pystacked for stacking regression and binary classification in Stata.",
      "tokens": [
        "In",
        "this",
        "article",
        ",",
        "we",
        "introduce",
        "pystacked",
        "for",
        "stacking",
        "regression",
        "and",
        "binary",
        "classification",
        "in",
        "Stata",
        "."
      ]
    },
    {
      "sentence": "pystacked allows users to fit multiple machine learning algorithms via Python's scikit-learn (Pedregosa et al.",
      "tokens": [
        "pystacked",
        "allows",
        "users",
        "to",
        "fit",
        "multiple",
        "machine",
        "learning",
        "algorithms",
        "via",
        "Python",
        "'s",
        "scikit-learn",
        "(",
        "Pedregosa",
        "et",
        "al",
        "."
      ]
    },
    {
      "sentence": "2011; Buitinck et al.",
      "tokens": [
        "2011",
        ";",
        "Buitinck",
        "et",
        "al",
        "."
      ]
    },
    {
      "sentence": "2013) and combine these into one final prediction as a weighted average of individual predictions.",
      "tokens": [
        "2013",
        ")",
        "and",
        "combine",
        "these",
        "into",
        "one",
        "final",
        "prediction",
        "as",
        "a",
        "weighted",
        "average",
        "of",
        "individual",
        "predictions",
        "."
      ]
    },
    {
      "sentence": "pystacked adds to the growing number of programs for machine learning in Stata, including, among others, lassopack for regularized regression (Ahrens et al.",
      "tokens": [
        "pystacked",
        "adds",
        "to",
        "the",
        "growing",
        "number",
        "of",
        "programs",
        "for",
        "machine",
        "learning",
        "in",
        "Stata",
        ",",
        "including",
        ",",
        "among",
        "others",
        ",",
        "lassopack",
        "for",
        "regularized",
        "regression",
        "(",
        "Ahrens",
        "et",
        "al",
        "."
      ]
    },
    {
      "sentence": "2020) , rforest for random forests (Schonlau and Zou 2020) and svm for support vector machines (Guenther 2016; Guenther and Schonlau 2018) .",
      "tokens": [
        "2020",
        ")",
        ",",
        "rforest",
        "for",
        "random",
        "forests",
        "(",
        "Schonlau",
        "and",
        "Zou",
        "2020",
        ")",
        "and",
        "svm",
        "for",
        "support",
        "vector",
        "machines",
        "(",
        "Guenther",
        "2016",
        ";",
        "Guenther",
        "and",
        "Schonlau",
        "2018",
        ")",
        "."
      ]
    },
    {
      "sentence": "Similarly to pystacked, Cerulli (2022) and Droste (2020) provide an interface to scikit-learn in Stata.",
      "tokens": [
        "Similarly",
        "to",
        "pystacked",
        ",",
        "Cerulli",
        "(",
        "2022",
        ")",
        "and",
        "Droste",
        "(",
        "2020",
        ")",
        "provide",
        "an",
        "interface",
        "to",
        "scikit-learn",
        "in",
        "Stata",
        "."
      ]
    },
    {
      "sentence": "mlrtime allows Stata users to make use of R's parsnip machine learning library (Huntington-Klein 2021) .",
      "tokens": [
        "mlrtime",
        "allows",
        "Stata",
        "users",
        "to",
        "make",
        "use",
        "of",
        "R",
        "'s",
        "parsnip",
        "machine",
        "learning",
        "library",
        "(",
        "Huntington-Klein",
        "2021",
        ")",
        "."
      ]
    },
    {
      "sentence": "pystacked differs from these in that it is, to our knowledge, the first to make stacking available to Stata users.",
      "tokens": [
        "pystacked",
        "differs",
        "from",
        "these",
        "in",
        "that",
        "it",
        "is",
        ",",
        "to",
        "our",
        "knowledge",
        ",",
        "the",
        "first",
        "to",
        "make",
        "stacking",
        "available",
        "to",
        "Stata",
        "users",
        "."
      ]
    },
    {
      "sentence": "Furthermore, pystacked can also be used to fit a single machine learner and thus provides an easy-to-use and versatile API to scikit-learn's machine learning algorithms.",
      "tokens": [
        "Furthermore",
        ",",
        "pystacked",
        "can",
        "also",
        "be",
        "used",
        "to",
        "fit",
        "a",
        "single",
        "machine",
        "learner",
        "and",
        "thus",
        "provides",
        "an",
        "easy-to-use",
        "and",
        "versatile",
        "API",
        "to",
        "scikit-learn",
        "'s",
        "machine",
        "learning",
        "algorithms",
        "."
      ]
    },
    {
      "sentence": "Stacking is widely used in applied predictive modeling in many disciplines, e.g., for predicting mortality (Hwangbo et al.",
      "tokens": [
        "Stacking",
        "is",
        "widely",
        "used",
        "in",
        "applied",
        "predictive",
        "modeling",
        "in",
        "many",
        "disciplines",
        ",",
        "e.g.",
        ",",
        "for",
        "predicting",
        "mortality",
        "(",
        "Hwangbo",
        "et",
        "al",
        "."
      ]
    },
    {
      "sentence": "2022) , bankruptcy filings (Liang et al.",
      "tokens": [
        "2022",
        ")",
        ",",
        "bankruptcy",
        "filings",
        "(",
        "Liang",
        "et",
        "al",
        "."
      ]
    },
    {
      "sentence": "2020; Fedorova et al.",
      "tokens": [
        "2020",
        ";",
        "Fedorova",
        "et",
        "al",
        "."
      ]
    },
    {
      "sentence": "2022) , or temperatures (Hooker et al.",
      "tokens": [
        "2022",
        ")",
        ",",
        "or",
        "temperatures",
        "(",
        "Hooker",
        "et",
        "al",
        "."
      ]
    },
    {
      "sentence": "2018) .",
      "tokens": [
        "2018",
        ")",
        "."
      ]
    },
    {
      "sentence": "The use of stacking as a method and pystacked as a program is, however, not only restricted to pure prediction or classification tasks.",
      "tokens": [
        "The",
        "use",
        "of",
        "stacking",
        "as",
        "a",
        "method",
        "and",
        "pystacked",
        "as",
        "a",
        "program",
        "is",
        ",",
        "however",
        ",",
        "not",
        "only",
        "restricted",
        "to",
        "pure",
        "prediction",
        "or",
        "classification",
        "tasks",
        "."
      ]
    },
    {
      "sentence": "A growing literature exploits machine learning to facilitate causal inference (see for an overview Athey and Imbens 2019) .",
      "tokens": [
        "A",
        "growing",
        "literature",
        "exploits",
        "machine",
        "learning",
        "to",
        "facilitate",
        "causal",
        "inference",
        "(",
        "see",
        "for",
        "an",
        "overview",
        "Athey",
        "and",
        "Imbens",
        "2019",
        ")",
        "."
      ]
    },
    {
      "sentence": "Indeed, a motivation for writing pystacked is that it can be used in combination with ddml (Ahrens et al.",
      "tokens": [
        "Indeed",
        ",",
        "a",
        "motivation",
        "for",
        "writing",
        "pystacked",
        "is",
        "that",
        "it",
        "can",
        "be",
        "used",
        "in",
        "combination",
        "with",
        "ddml",
        "(",
        "Ahrens",
        "et",
        "al",
        "."
      ]
    },
    {
      "sentence": "2023a,b) , which implements the Double-Debiased Machine Learning (DDML) methodology of Chernozhukov et al.",
      "tokens": [
        "2023a",
        ",",
        "b",
        ")",
        ",",
        "which",
        "implements",
        "the",
        "Double-Debiased",
        "Machine",
        "Learning",
        "(",
        "DDML",
        ")",
        "methodology",
        "of",
        "Chernozhukov",
        "et",
        "al",
        "."
      ]
    },
    {
      "sentence": "(2018) .",
      "tokens": [
        "(",
        "2018",
        ")",
        "."
      ]
    },
    {
      "sentence": "DDML utilizes cross-fitting, a form of iterative sample splitting, which allows leveraging a wide class of supervised machine learners, including stacking, for the estimation of causal parameters.",
      "tokens": [
        "DDML",
        "utilizes",
        "cross-fitting",
        ",",
        "a",
        "form",
        "of",
        "iterative",
        "sample",
        "splitting",
        ",",
        "which",
        "allows",
        "leveraging",
        "a",
        "wide",
        "class",
        "of",
        "supervised",
        "machine",
        "learners",
        ",",
        "including",
        "stacking",
        ",",
        "for",
        "the",
        "estimation",
        "of",
        "causal",
        "parameters",
        "."
      ]
    },
    {
      "sentence": "For instance, in the context of DDML, stacking can be used to estimate the conditional expectation of an outcome with respect to confounders or propensity scores.",
      "tokens": [
        "For",
        "instance",
        ",",
        "in",
        "the",
        "context",
        "of",
        "DDML",
        ",",
        "stacking",
        "can",
        "be",
        "used",
        "to",
        "estimate",
        "the",
        "conditional",
        "expectation",
        "of",
        "an",
        "outcome",
        "with",
        "respect",
        "to",
        "confounders",
        "or",
        "propensity",
        "scores",
        "."
      ]
    },
    {
      "sentence": "We stress that pystacked relies on Python's scikit-learn (version 0.24 or higher) and the ongoing work of the scikit-learn contributors.",
      "tokens": [
        "We",
        "stress",
        "that",
        "pystacked",
        "relies",
        "on",
        "Python",
        "'s",
        "scikit-learn",
        "(",
        "version",
        "0.24",
        "or",
        "higher",
        ")",
        "and",
        "the",
        "ongoing",
        "work",
        "of",
        "the",
        "scikit-learn",
        "contributors",
        "."
      ]
    },
    {
      "sentence": "Thus, pystacked relies on Stata's Python integration which was introduced in Stata 16.0.",
      "tokens": [
        "Thus",
        ",",
        "pystacked",
        "relies",
        "on",
        "Stata",
        "'s",
        "Python",
        "integration",
        "which",
        "was",
        "introduced",
        "in",
        "Stata",
        "16.0",
        "."
      ]
    },
    {
      "sentence": "We kindly ask users to cite scikit-learn along with this article when using pystacked.",
      "tokens": [
        "We",
        "kindly",
        "ask",
        "users",
        "to",
        "cite",
        "scikit-learn",
        "along",
        "with",
        "this",
        "article",
        "when",
        "using",
        "pystacked",
        "."
      ]
    },
    {
      "sentence": "Throughout we refer to version 0.7 of pystacked, which is the latest version at the time of writing.",
      "tokens": [
        "Throughout",
        "we",
        "refer",
        "to",
        "version",
        "0.7",
        "of",
        "pystacked",
        ",",
        "which",
        "is",
        "the",
        "latest",
        "version",
        "at",
        "the",
        "time",
        "of",
        "writing",
        "."
      ]
    },
    {
      "sentence": "Please check for updates to pystacked on a regular basis and consult the help file to be informed about new features.",
      "tokens": [
        "Please",
        "check",
        "for",
        "updates",
        "to",
        "pystacked",
        "on",
        "a",
        "regular",
        "basis",
        "and",
        "consult",
        "the",
        "help",
        "file",
        "to",
        "be",
        "informed",
        "about",
        "new",
        "features",
        "."
      ]
    },
    {
      "sentence": "The pystacked help file includes information on how to install a recent Python version and set up Stata's Python integration.",
      "tokens": [
        "The",
        "pystacked",
        "help",
        "file",
        "includes",
        "information",
        "on",
        "how",
        "to",
        "install",
        "a",
        "recent",
        "Python",
        "version",
        "and",
        "set",
        "up",
        "Stata",
        "'s",
        "Python",
        "integration",
        "."
      ]
    },
    {
      "sentence": "Section 2 introduces stacking.",
      "tokens": [
        "Section",
        "2",
        "introduces",
        "stacking",
        "."
      ]
    },
    {
      "sentence": "Section 3 presents the main features of the pystacked program.",
      "tokens": [
        "Section",
        "3",
        "presents",
        "the",
        "main",
        "features",
        "of",
        "the",
        "pystacked",
        "program",
        "."
      ]
    },
    {
      "sentence": "Section 4 demonstrates the use of the program using examples.",
      "tokens": [
        "Section",
        "4",
        "demonstrates",
        "the",
        "use",
        "of",
        "the",
        "program",
        "using",
        "examples",
        "."
      ]
    }
  ]
}